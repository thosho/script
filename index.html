<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fountain to Screenplay Converter</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #f8f8f8;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #editor {
            width: 100%;
            max-width: 800px;
            height: 300px;
            font-size: 16px;
            padding: 10px;
            border: 1px solid #ccc;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        #convert-btn {
            padding: 10px 20px;
            background-color: #333;
            color: white;
            border: none;
            cursor: pointer;
            margin-bottom: 20px;
        }
        #output {
            width: 100%;
            max-width: 800px;
            background-color: white;
            padding: 20px;
            border: 1px solid #ccc;
            white-space: pre-wrap;
            line-height: 1.5;
            box-sizing: border-box;
        }
        .title-page {
            text-align: center;
            margin-bottom: 50px;
        }
        .scene-heading {
            font-weight: bold;
            text-transform: uppercase;
            margin-top: 20px;
        }
        .action {
            margin: 10px 0;
        }
        .character {
            text-transform: uppercase;
            margin-left: 200px;
            margin-top: 20px;
        }
        .dialogue {
            margin-left: 150px;
            margin-right: 150px;
        }
        .parenthetical {
            margin-left: 180px;
        }
        .transition {
            text-align: right;
            text-transform: uppercase;
            font-weight: bold;
            margin: 20px 0;
        }
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            #editor {
                height: 200px;
            }
            .character {
                margin-left: 100px;
            }
            .dialogue {
                margin-left: 50px;
                margin-right: 50px;
            }
            .parenthetical {
                margin-left: 80px;
            }
        }
    </style>
</head>
<body>
    <textarea id="editor" placeholder="Enter your Fountain markup here..."></textarea>
    <button id="convert-btn">Convert to Screenplay</button>
    <div id="output"></div>

    <script>
        // Simplified Fountain parser based on Fountain.js logic
        // This is a basic implementation for demonstration; for full features, integrate a complete parser like Fountain.js
        function parseFountain(input) {
            const lines = input.split('\n');
            let html = '';
            let inDialogue = false;
            let currentCharacter = '';

            lines.forEach(line => {
                line = line.trim();

                if (!line) {
                    return;
                }

                // Title page detection (simple key:value)
                if (line.includes(':')) {
                    const [key, value] = line.split(':');
                    if (['Title', 'Author', 'Draft date'].includes(key.trim())) {
                        html += `<div class="title-page"><h1>${value.trim()}</h1></div>`;
                        return;
                    }
                }

                // Scene headings start with INT. or EXT.
                if (line.toUpperCase().startsWith('INT.') || line.toUpperCase().startsWith('EXT.')) {
                    html += `<div class="scene-heading">${line.toUpperCase()}</div>`;
                    inDialogue = false;
                    return;
                }

                // Transitions end with TO: or are like FADE OUT.
                if (line.toUpperCase().endsWith('TO:') || line.toUpperCase() === 'FADE OUT.') {
                    html += `<div class="transition">${line.toUpperCase()}</div>`;
                    inDialogue = false;
                    return;
                }

                // Character names are uppercase, not starting with !
                if (line === line.toUpperCase() && !line.startsWith('!') && line.length > 0) {
                    currentCharacter = line;
                    html += `<div class="character">${line}</div>`;
                    inDialogue = true;
                    return;
                }

                // Parentheticals start with (
                if (inDialogue && line.startsWith('(')) {
                    html += `<div class="parenthetical">${line}</div>`;
                    return;
                }

                // Dialogue follows character
                if (inDialogue) {
                    html += `<div class="dialogue">${line}</div>`;
                    return;
                }

                // Default to action lines
                html += `<div class="action">${line}</div>`;
            });

            return html;
        }

        document.getElementById('convert-btn').addEventListener('click', () => {
            const input = document.getElementById('editor').value;
            const output = parseFountain(input);
            document.getElementById('output').innerHTML = output;
        });
    </script>
</body>
</html>
